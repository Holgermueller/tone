<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>TONE</title>

    <!-- Materialize -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="./asssets/css/materialize.css"  media="screen,projection"/>

    <!--Viewport-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- Link to CSS file -->
        <link rel="stylesheet" href="./asssets/css/style.css">

    <!-- Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Assistant:300|Poiret+One" rel="stylesheet">

</head>
<body class="content-body">
    <header class="row z-depth-2 content-header col s12 ">
        <h1 class="content-h1">TONE</h1>
    </header>
    <main class="content-main container">
      
        <div>
      
        <div class="row">
            <button class="getSlack">Get The Slack Info</button>
        </div>
        <div id="all-messages">
            <div class="user-message">
                <div class="row message-head">
                    <div class="chip username">Jane Doe</div>

                    <a href="test.html">link text</a>
                    <div class="right timestamp"> Time AMPM</div>
                </div>
                <p class="row message-text"> This may be offensive...</p>
                <div id="percentage" class="right timestamp"></div>

            </div>
        </div>
        
    </main>
    <footer class="row ">


    <div class="message-footer">    
    
        <form class="container">
            <div class="row">
              <div class="input-field col s11">
                <textarea id="textarea1" class="materialize-textarea"></textarea>
                <label for="textarea1">Check your Tone</label>
                <button id="check-button" class="btn waves-effect waves-light right slack-submit col s1" type="submit" name="action">
                       <i class="material-icons right">send</i>
                      </button>
                      
              </div>
              
            </div>
    
          </form>
    </div>


    </footer>
        
<!-- Floating Action Button -->
    <!-- <div class="fixed-action-btn">
        <a class="btn-floating btn-large menu-button waves-effect waves-light">
            <i class="large material-icons menu-button waves-effect">menu</i>
        </a>
        <ul>
        <li><a class="btn-floating create-button"><i class="material-icons create-button">create</i></a></li>
        <li><a class="btn-floating account-button"><i class="material-icons account-button">filter_list</i></a></li>
        </ul>
    </div> -->


<!-- JQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Materialize JS -->
    <script type="text/javascript" src="./asssets/javascript/materialize.js"></script>

<!-- Link to JS file -->
  <!-- <script src="asssets/javascript/perspective.js" ></script> -->
 
<script>

let contentToAnalize = ""

// This Ajax call gives us the analized content from the perpective API







// Analize content as you type


var texto =   $('#textarea1').val();
  M.textareaAutoResize($('#textarea1'));
        
        

$('#check-button').on('click',function(){
    

    $.ajax({
    contentType: "application/json",
    data: JSON.stringify({
            comment: {
                    text: "stupid"
            },
            languages: ["en"],
            requestedAttributes: {
                    TOXICITY: {}
            }
    }),
    method: 'POST',
    url: 'https://commentanalyzer.googleapis.com/v1alpha1/comments:analyze?key=AIzaSyC_mGbSsEJnpL8tD7BnO5jRXS_uTPMyFwE',
    success: function(response) {
            console.log(response);
            console.log(response.attributeScores.TOXICITY.summaryScore.value);

            let toxicity = response.attributeScores.TOXICITY.summaryScore.value

            let toxicityPercentage = (toxicity*100).toFixed(0)

            console.log(toxicityPercentage)

            $('#percentage').text(toxicityPercentage + "% Toxic")
    }
});


});


</script>


</body>
</html>